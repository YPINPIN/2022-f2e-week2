import{_ as k,a as S,b as y,c as C,d as I,e as F,f as D,g as E,h as H,i as M,j as z,k as q,l as N,m as B,n as L,o as O,p as U,q as j,r as R,s as A,t as T,u as x,v as P,w as W,x as X,y as Y,z as $,A as G,B as J,C as K,D as V,E as Q,F as Z,G as ss,H as es,I as ts,J as is,K as _s,L as as,M as os}from"./main.544b1449.js";import{_ as cs,m as rs,o as n,c as l,a as e,F as d,l as h,k as m,n as b,d as p,v as u,t as ns,p as ls,e as gs}from"./index.92bc3226.js";import{p as f}from"./pdfHelper.219c2212.js";import{_ as w}from"./ic_add_dark.3881e144.js";const vs={name:"SignEdit",data(){return{tabs:["sign","pic","text","page"],tabsInfo:["\u7C3D\u540D","\u5716\u7247","\u6587\u5B57","\u9801\u6578"],tabsHover:[!1,!1,!1,!1],deleteIcon:"data:image/svg+xml,%3Csvg width='40' height='40' viewBox='0 0 40 40' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Ccircle cx='20' cy='20' r='10.75' stroke='%234D4D4D' stroke-width='2.5'/%3E%3Cpath d='M16 24L23.7782 16.2218' stroke='%234D4D4D' stroke-width='2.5' stroke-linecap='round'/%3E%3Cpath d='M24 24L16.2218 16.2218' stroke='%234D4D4D' stroke-width='2.5' stroke-linecap='round'/%3E%3C/svg%3E",img:null,cornerSize:24}},mounted(){let s=document.querySelector(".preview-canvas");this.fitToContainer(s),this.uploadFilePreview(),this.setFabric()},computed:{...rs(["uploadFile","signFiles"])},methods:{getImageUrl(s){return new URL(Object.assign({"/src/assets/images/button/ic_add_dark.svg":k,"/src/assets/images/button/ic_add_tint.svg":S,"/src/assets/images/icon/ic_archive.svg":y,"/src/assets/images/icon/ic_archive_h.svg":C,"/src/assets/images/icon/ic_close.svg":I,"/src/assets/images/icon/ic_close_h.svg":F,"/src/assets/images/icon/ic_close_s.svg":D,"/src/assets/images/icon/ic_color_black.svg":E,"/src/assets/images/icon/ic_color_black_h.svg":H,"/src/assets/images/icon/ic_color_blue.svg":M,"/src/assets/images/icon/ic_color_blue_h.svg":z,"/src/assets/images/icon/ic_color_red.svg":q,"/src/assets/images/icon/ic_color_red_h.svg":N,"/src/assets/images/icon/ic_download.svg":B,"/src/assets/images/icon/ic_download_h.svg":L,"/src/assets/images/icon/ic_file_h.svg":O,"/src/assets/images/icon/ic_help.svg":U,"/src/assets/images/icon/ic_help_h.svg":j,"/src/assets/images/icon/ic_page.svg":R,"/src/assets/images/icon/ic_page_h.svg":A,"/src/assets/images/icon/ic_pic.svg":T,"/src/assets/images/icon/ic_pic_h.svg":x,"/src/assets/images/icon/ic_sign.svg":P,"/src/assets/images/icon/ic_sign_h.svg":W,"/src/assets/images/icon/ic_text.svg":X,"/src/assets/images/icon/ic_text_h.svg":Y,"/src/assets/images/icon/ic_trash.svg":$,"/src/assets/images/icon/ic_trash_h.svg":G,"/src/assets/images/icon/ic_user.svg":J,"/src/assets/images/icon/ic_user_h.svg":K,"/src/assets/images/logo/logo_darkbg_horizontal.png":V,"/src/assets/images/other/arrow.svg":Q,"/src/assets/images/other/arrow_small.svg":Z,"/src/assets/images/other/bg_decorate.svg":ss,"/src/assets/images/other/img_archive.svg":es,"/src/assets/images/other/img_photo.svg":ts,"/src/assets/images/other/img_trash.svg":is,"/src/assets/styles/_color.scss":_s,"/src/assets/styles/_reset.scss":as,"/src/assets/styles/main.scss":os})[`/src/assets/${s}`],self.location).href},fitToContainer(s){s.style.width="100%",s.style.height="100%",s.width=s.offsetWidth,s.height=s.offsetHeight},async uploadFilePreview(){if(this.uploadFile===void 0)return;const s=new fabric.Canvas("preview-canvas");document.querySelector("#preview-canvas").fabric=s,s.requestRenderAll();let t=document.querySelector(".preview-canvas").width;const o=await f.printPDF(this.uploadFile,t),i=await f.pdfToImage(o);s.setWidth(i.width),s.setHeight(i.height),s.setBackgroundImage(i,s.renderAll.bind(s))},onSignFileClick(s){if(!s.target.src)return;let t=s.target.src,o=document.querySelector("#preview-canvas").fabric;fabric.Image.fromURL(t,function(i){i.top=0,i.scaleX=.3,i.scaleY=.3,o.add(i)}),this.setHasEdit(!0)},setHasEdit(s){this.$store.commit("setHasEdit",s)},openNewSign(){this.$store.dispatch("isNewSignModalOpen",!0)},setFabric(){this.img=document.createElement("img"),this.img.src=this.deleteIcon,fabric.Object.prototype.controls.deleteControl=new fabric.Control({x:-.5,y:-.5,offsetX:-15,offsetY:-15,cursorStyle:"pointer",mouseUpHandler:this.deleteObject,render:this.renderIcon,cornerSize:this.cornerSize})},deleteObject(s,t){let o=t.target,i=o.canvas;i.remove(o),i.requestRenderAll()},renderIcon(s,t,o,i,c){let _=this.cornerSize;s.save(),s.translate(t,o),s.rotate(fabric.util.degreesToRadians(c.angle)),s.drawImage(this.img,-_/2,-_/2,_,_),s.restore()}}},g=s=>(ls("data-v-98db4c26"),s=s(),gs(),s),ds={class:"sign-edit"},hs={class:"edit-left"},ms={class:"edit-left-tabs"},bs=["onMouseenter","onMouseleave"],ps=["src","alt"],us=["src","alt"],fs={class:"edit-left-body"},ws={class:"sign-block"},ks={key:0,class:"sign-list"},Ss={class:"sign-list-wrapper"},ys=["src"],Cs=g(()=>e("img",{src:w,alt:"btn-add"},null,-1)),Is=[Cs],Fs={key:1,class:"sign-add"},Ds=g(()=>e("img",{src:w,alt:"btn-add"},null,-1)),Es=[Ds],Hs=g(()=>e("h5",{class:"sign-add-text"},"\u65B0\u589E\u7C3D\u540D\u6A94",-1)),Ms=g(()=>e("section",{class:"edit-right"},[e("div",{class:"edit-right-preview"},[e("div",{class:"preview-wrapper"},[e("canvas",{id:"preview-canvas",class:"preview-canvas"})])])],-1));function zs(s,t,o,i,c,_){return n(),l("section",ds,[e("section",hs,[e("div",ms,[(n(!0),l(d,null,h(c.tabs,(a,r)=>(n(),l("div",{key:r,class:b(["tabs-item",`tabs-${a}`])},[e("button",{class:b([`tabs-${a}-btn`]),onMouseenter:v=>c.tabsHover[r]=!0,onMouseleave:v=>c.tabsHover[r]=!1},[p(e("img",{src:_.getImageUrl(`images/icon/ic_${a}.svg`),alt:[`btn-${a}`]},null,8,ps),[[u,!c.tabsHover[r]]]),p(e("img",{src:_.getImageUrl(`images/icon/ic_${a}_h.svg`),alt:[`btn-${a}-hover`]},null,8,us),[[u,c.tabsHover[r]]])],42,bs),e("p",null,ns(c.tabsInfo[r]),1)],2))),128))]),e("div",fs,[e("div",ws,[s.signFiles.length>0?(n(),l("div",ks,[e("div",Ss,[(n(!0),l(d,null,h(s.signFiles,(a,r)=>(n(),l("div",{key:r,class:"sign-list-item"},[e("img",{onClick:t[0]||(t[0]=(...v)=>_.onSignFileClick&&_.onSignFileClick(...v)),class:"sign",width:"240",height:"100",src:`${a}`},null,8,ys)]))),128))]),e("button",{class:"sign-add-btn",onClick:t[1]||(t[1]=m((...a)=>_.openNewSign&&_.openNewSign(...a),["stop","prevent"]))},Is)])):(n(),l("div",Fs,[e("button",{class:"sign-add-btn",onClick:t[2]||(t[2]=m((...a)=>_.openNewSign&&_.openNewSign(...a),["stop","prevent"]))},Es),Hs]))])])]),Ms])}const Os=cs(vs,[["render",zs],["__scopeId","data-v-98db4c26"]]);export{Os as default};
